var addTopicInputRow=function(a,b){var c=$("#video-bookmark-table tbody");if(1<c.find("tr.inputRow").length)return UI_alert("Please complete this topic first"),!1;var d=c.find("tr.inputRow.dummyRow").clone(!0);d.removeClass("dummyRow").find("textarea","input").each(function(){this.value=""});"top"==b?d.prependTo(c).css("display","table-row"):(c=$(a.target).closest("tr"),d.insertAfter(c).css("display","table-row"))},bindNewBookmarkIcon=function(a){$(a.currentTarget).hasClass("topic-row")?addTopicInputRow(a):
addTopicInputRow(a,"top")},bindCancelNewBookmarkIcon=function(a){a=$(a.currentTarget).closest(".inputRow");a.hasClass("bookmark-edit-row")&&a.prev(".edit-state-disabled").removeClass("edit-state-disabled");a.remove()},bindAddBookmarkTopic=function(a){var b=$(a.currentTarget).closest(".inputRow"),c=$("#video-bookmark-table tbody");a=validateBookmarkTopicsData(a);a.status?(b.hasClass("bookmark-edit-row")?(c=b.prev(".readOnlyRow"),c.removeClass("edit-state-disabled")):(c=c.find("tr.readOnlyRow.dummyRow").clone(!0),
c.removeClass("dummyRow")),c.find(".bookmark-topic-text").attr("data-topic-val",b.find(".topic-text-input").val()).html(b.find(".topic-text-input").val()),c.find(".bookmark-topic-start").attr("data-time-val",b.find(".topic-start-time").val()).html(secondsToTimeStr(b.find(".topic-start-time").val())),c.find(".bookmark-topic-end").attr("data-time-val",b.find(".topic-end-time").val()).html(secondsToTimeStr(b.find(".topic-end-time").val())),c.insertBefore(b),b.remove()):showBookmarkTopicError(a)},bindEditBookmarkIcon=
function(a){var b=$("#video-bookmark-table tbody");if(1<b.find("tr.inputRow").length)return UI_alert("Please complete this topic first"),!1;a=$(a.currentTarget).closest("tr.readOnlyRow");a.addClass("edit-state-disabled");b=b.find("tr.inputRow.dummyRow").clone(!0);b.removeClass("dummyRow").addClass("bookmark-edit-row").find("textarea","input").each(function(){this.value=""});b.insertAfter(a).css("display","table-row");b.find(".topic-text-input").val(a.find(".bookmark-topic-text").attr("data-topic-val"));
b.find(".topic-start-time").val(a.find(".bookmark-topic-start").attr("data-time-val"));b.find(".topic-end-time").val(a.find(".bookmark-topic-end").attr("data-time-val"))},bindRemoveBookmarkTopic=function(a){$(a.currentTarget).closest(".readOnlyRow").remove()},bindShiftTimeInput=function(a){a=$(a.currentTarget);var b=a.closest("td").find(".topics-time-input");a.hasClass("left-shift")?b.val(parseFloat(b.val())-.25):b.val(parseFloat(b.val())+.25)},bindcurrentPTSTimeInput=function(a){$(a.currentTarget).closest("td").find(".topics-time-input").val(vidPlayerObject.GetCurrentPTS().toFixed(1))},
validateBookmarkTopicsData=function(a){var b={status:!0},c=$(a.currentTarget).closest(".inputRow"),d=c.find(".topic-text-input").val().trim(),e=c.find(".topic-start-time").val().trim(),c=c.find(".topic-end-time").val().trim(),f=$(a.currentTarget).closest(".inputRow").prev(".readOnlyRow:not(.edit-state-disabled)");a=$(a.currentTarget).closest(".inputRow").next(".readOnlyRow:not(.edit-state-disabled)");var g=e,h=c;0<f.length&&(g=parseFloat(f.find(".bookmark-topic-end").attr("data-time-val")));0<a.length&&
(h=parseFloat(a.find(".bookmark-topic-start").attr("data-time-val")));if(IsValueNull(d))return b.status=!1,b.errorCode=1,b;if(IsValueNull(e))return b.status=!1,b.errorCode=2,b;if(IsValueNull(c))return b.status=!1,b.errorCode=3,b;if(parseFloat(e)>=parseFloat(c))return b.status=!1,b.errorCode=4,b;if(e<g)return b.status=!1,b.errorCode=5,b;c>h&&(b.status=!1,b.errorCode=6);return b},showBookmarkTopicError=function(a){switch(a.errorCode){case 1:UI_alert("Topic name cannot be left empty");break;case 2:UI_alert("Topic start time cannot be left empty");
break;case 3:UI_alert("Topic end time cannot be left empty");break;case 4:UI_alert("Topic start time cannot be greater than topic end time");break;case 5:UI_alert("Topic start time must be greater than the previous topic end time");break;case 6:UI_alert("Topic end time must be less than the next topic start time")}},saveBookmarkData=function(a){a=$("#video-bookmark-table tbody tr.readOnlyRow:not(.dummyRow)");bookMarkTopicsArr=[];if(0==a.length)bookMarkTopicsArr.push({topic:$("#bookmarks-title").val(),
start_time:0,end_time:99999});else for(var b,c,d,e=0;e<a.length;e++)b=a.eq(e).find(".bookmark-topic-text").attr("data-topic-val"),c=a.eq(e).find(".bookmark-topic-start").attr("data-time-val"),d=a.eq(e).find(".bookmark-topic-end").attr("data-time-val"),bookMarkTopicsArr.push({topic:b,start_time:c,end_time:d});a={};b=$("#bookmarks-title").val();c=$("#bookmark-ptremember").val();a.topicinfo=JSON.stringify({topic_info:bookMarkTopicsArr});a.title=b;a.videoid=data.videoID;a.sourcevideoid=contentObj[data.videoID].videoid;
a.metadata=c;b=new CommonUtils.remoteCallClass;b.requestData={request:"bookmark_save",data:a};b.syncPostRequest("./"+dataRequestURL,BookmarkSaveRequestCallback);data.bookMarkTopicsArr=bookMarkTopicsArr},playContentThroughBookmark=function(a){if(1>bookMarkTopicsArr.length)return UI_alert("please save your bookmarks first"),!1;$(".contentSpecificVisible").css("display","none");$("#viewbookmarks").css("display","block");$(".playListContainer").removeClass("playListContainer");$("#viewbookmarks").addClass("playListContainer");
$(".indexSwitch").css("display","none");!IsValueNull(data.topics[data.videoID])&&0<JSON.parse(data.topics[data.videoID]).topic_info.length&&$(".indexSwitch.index-topics").css("display","block");a='<div class="arrup"></div><ul>';for(var b in bookMarkTopicsArr)a+="<li data-topic-index="+b+'><div class="topic-name">'+bookMarkTopicsArr[b].topic+'</div><div class="topic-start-time">'+getTimeFormatStr(bookMarkTopicsArr[b].start_time)+"</div></li>";a+='</ul><div class="arrdown"></div>';$(".bookmarklist-container").html(a);
b=bookMarkTopicsArr.length;newSegInfo=new sSegmentInfo;newSegInfo.videoID=contentObj[data.videoID].videoid;newSegInfo.segmentList=[];for(i=0;i<b;i++)a=new sVideoSegment,a.startTime=bookMarkTopicsArr[i].start_time,a.endTime=bookMarkTopicsArr[i].end_time,a.topicText=bookMarkTopicsArr[i].topic,newSegInfo.segmentList.push(a);playSegments()},BookmarkSaveRequestCallback=function(a){a=JSON.parse(a);validateAppResponse(a)?UI_alert("Bookmarks saved successfully"):(UI_alert("Error! Bookmarks not saved"),bookMarkTopicsArr=
[])},getBookMarksData=function(){data.bookMarkTopicsArr=[];bookMarkTopicsArr=[];$("#video-bookmark-table").find("tr.inputRow:not(.dummyRow),tr.readOnlyRow:not(.dummyRow)").remove();$("#bookmark-ptremember,#bookmarks-title").val("");var a=new CommonUtils.remoteCallClass;a.requestData={request:"bookmark_read",data:{videoid:data.videoID}};a.syncPostRequest("./"+dataRequestURL,BookmarkDataRequestCallback)},BookmarkDataRequestCallback=function(a){a=JSON.parse(a);validateAppResponse(a)&&(a=a.data,0<Object.keys(a).length&&
(a=a[Object.keys(a)[0]],IsValueNull(a)||(data.currentBookmarkObject=a,bookMarkTopicsArr=data.bookMarkTopicsArr=JSON.parse(a.topicinfo).topic_info,$("#bookmarks-title").val(a.title),$("#bookmark-ptremember").val(a.metadata),renderSavedBookMarks())))},renderSavedBookMarks=function(){$("#video-bookmark-table").find("tr.inputRow:not(.dummyRow),tr.readOnlyRow:not(.dummyRow)").remove();$("#bookmark-ptremember,#bookmarks-title").val("");var a=$("#video-bookmark-table tbody"),b=$("#video-bookmark-table tr.readOnlyRow.dummyRow"),
c;$("#bookmarks-title").val(data.currentBookmarkObject.title);$("#bookmark-ptremember").val(data.currentBookmarkObject.metadata);bookMarkTopicsArr=data.bookMarkTopicsArr;for(var d in bookMarkTopicsArr)c=b.clone(!0),c.removeClass("dummyRow"),c.find(".bookmark-topic-text").html(bookMarkTopicsArr[d].topic).attr("data-topic-val",bookMarkTopicsArr[d].topic),c.find(".bookmark-topic-start").html(secondsToTimeStr(bookMarkTopicsArr[d].start_time)).attr("data-time-val",bookMarkTopicsArr[d].start_time),c.find(".bookmark-topic-end").html(secondsToTimeStr(bookMarkTopicsArr[d].end_time)).attr("data-time-val",
bookMarkTopicsArr[d].end_time),a.append(c)};